# Markdown 转 Word 文档生成

该模块提供了一个统一的入口函数，用于将 Markdown 文本解析、清洗并转换为格式规范的 Word 文档，随后自动上传至指定的文件服务器，返回可供下载的链接。

## 1. 核心功能

* **智能清洗与修复**：
    * 自动处理不规范的 Markdown 缩进。
    * **表格上下文修复**：自动识别紧贴文本的表格语法，强制插入换行符，防止表格无法被解析。
* **富文本格式支持**：
    * 支持标题（H1-H6）、列表（有序/无序）、引用块、代码块、粗体/斜体等。
    * 支持图片标签占位处理（转换为 `[图片: 说明]` 格式）。
* **Word 样式定制**：
    * **中西文混排**：默认字体统一设置为 **Times New Roman** (西文) 和 **宋体** (中文)，字号 10.5pt。
    * **表格美化**：自动应用 `Table Grid` 样式，确保表格显示完整的黑色边框，表头自动加粗。
    * **代码高亮**：代码块使用 `Consolas` 字体。
* **自动化上传**：生成的文档流直接上传至 OSS 接口，无需落地本地文件。

## 2. 依赖安装

运行此模块需要安装以下 Python 第三方库：

## 依赖安装

环境要求 Python 3.8+，需安装以下库：

```bash
pip install markdown python-docx beautifulsoup4 requests
```
## 接口说明
### 1. 请求参数 (Input)

| 参数名    | 类型 | 必填 | 说明                                                               |
|-----------|------|------|--------------------------------------------------------------------|
| md_text   | str  | ✅    | 需要转换的原始 Markdown 字符串                                       |
| auth_token | str  | ✅    | 上传接口鉴权用的 Bearer Token                                       |
| base_url  | str  | ✅    | 服务器 API 基础地址 (例如 `http://api.example.com`)                   |
| filename  | str  | ✅    | 目标文件名                   |

### 2. 响应参数 (Output)
### 成功时
返回包含下载链接的 HTML 字符串。
**格式示例：**
```html
<html_rander>
  <a href="..." download="...">文件名.docx</a>
</html_rander>
```
### 失败时：返回错误描述字符串（以 ✗ 开头）。

## 格式映射表对照
| Markdown 元素            | Word (.docx) 样式/处理                                                                 |
|--------------------------|--------------------------------------------------------------------------------------|
| 普通文本                 | 字体：Times New Roman + 宋体 / 字号：10.5pt                                             |
| 标题 (#)                 | 对应 Word 原生标题样式 (Heading 1 ~ Heading 6)                                        |
| 粗体/斜体                | 保留样式，粗体同时适用于表格表头 (`<th>`)                                              |
| 列表 (-/1.)              | 自动缩进，首行悬挂缩进，序号/圆点加粗                                                  |
| 代码块 (` ``` `)         | 字体：Consolas (9.5pt)，颜色：深灰，左缩进处理                                         |
| 引用 (>)                 | 样式：Quote，左缩进 0.5 英寸，字体灰色                                                 |
| 表格                     | 样式：Table Grid (带全边框)，单元格内容自动清除默认空行                                 |
| 图片 (`![]`)             | 转换为文本占位符：`[图片: 图片描述]`，灰色字体                                         |
| 链接 (`[]`)              | 蓝色字体，带下划线                                                                    |
| 分割线 (`---`)           | 居中显示的连续长划线 (`―`)                                                             |

